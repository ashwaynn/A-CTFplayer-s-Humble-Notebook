
# Linux Enumeration Techniques for PrivEsc

## Investigation of sudo privileges for the current user

```bash
sudo -l
```
## Investigation of the current user's cron jobs

```bash
crontab -l
```

## `find` command

### Finding SUID files

```bash
find / -perm -u=s -type f 2>/dev/null
```

**NOTE**: *enlightenment_sys* is a famous vulnerable SUID binary and is commonly found in CTFs.

**NOTE**: If a "bash" ELF file has SUID bit set, then run with `-p` option **to ensure that the permissions are retained**.

```bash
-rwsr-sr-x 1 root  root  1113504 Jul 22  2020 .suid_bash

# Running suid_bash without -p

./.suid_bash

.suid_bash-4.4$ id
uid=1000(james) gid=1000(james) groups=1000(james),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)

# Running suid_bash WITH -p

./.suid_bash -p

.suid_bash-4.4# id
uid=1000(james) gid=1000(james) euid=0(root) egid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd),1000(james)

.suid_bash-4.4# whoami
root
```

## The `.env` file

Usually present in the application's root directory (or within a sub directory). May contain very useful key-value pairs like DB username, DB password etc.


## Sockets Investigation

### ss

```bash
ss -tulpn
```

`-t` - Displays TCP sockets

`-u` - Displays UDP sockets

`-l` - Displays only listening sockets

`-p` - Shows the process using the socket

`-n` - Doesn't resolve service names

## Check the email inboxes of users

```bash
cd /var/mail

ls -la #Lists all the users' mailbox files (if any)
```

