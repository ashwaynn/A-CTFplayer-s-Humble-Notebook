# Nmap

## Technique 1 - An "All in one" kind of scan

```bash
nmap -A 10.10.11.227 -v -Pn
```

`-A` - Performs an "All in one" kind of aggressive scan which includes OS detection, version detection, script scanning, and traceroute.

`-v` - For verbose O/p (`-vv` or more 'v's increases the verbosity level).

`-Pn` - Skips host discovery and will consider the system to be online.


## Technique 2 - A basic scan

```bash
nmap -sC -sV <IP>
```

`-sC` - For default scripts

`-sV` - For version detection

## Technique 3 - A super fast scan covering all 65,535 ports.

Scanning all 65,535 ports is **very useful to find hidden services** (especially hidden HTTP services) **running on uncommon ports**.

```bash
sudo nmap -sS 10.10.11.16 -Pn -v -p-
```

<u>*Important points to note :</u>*

- Use a SYN scan `-sS` which is **faster** than a TCP Connect Scan `-sT`. This is because SYN scan does not complete the TCP three-way handshake while the Connect Scan does. So a faster scan helps in completing the scanning of the entire port range more quickly.

- Using a SYN scan is **more stealthier** than a Connect scan as the former scan does not complete the full handshake and is less likely to be logged by the target.

- Carrying out a SYN scan **requires root privileges** and hence the use of `sudo` in the above command. This is because to perform a SYN scan, **direct control over the network packets is necessary** and hence the need for higher privileges; but when performing a TCP connect scan, it just **relies on the networking stack of the OS to establish the required connections** which does not require root privileges. Hence the TCP connect scan can be carried out by a non-root user. 


## Technique 4 - UDP scan

```bash
sudo nmap -sU -p 161 10.10.11.248 -v -Pn   // UDP scan
```

`-sU` - For UDP scan

`-p 161` - For specifying the port to be scanned; in this case the port 161 (SNMP port) will be scanned.


## Technique 5 - Using specific SMB enum-based NSE scipts

```bash
nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.80.123
```

`smb-enum-shares.nse` - Aims to determine the available shares on the remote system and the shares' info.

`smb-enum-users.nse` - Aims to determine the users on the remote Windows system.


## Technique 6 - Enumerating NFS in Linux via RPCbind

```bash
nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount 10.10.80.123
```

**Port 111** is used by the Portmapper service, also known as RPCbind, which manages RPC services. Clients can query the Portmapper to find the port number associated with a specific RPC service.

`nfs-ls` - For info about the files in NFS exports.

`nfs-statfs` - For info such as disk space statics of a NFS share

`nfs-showmount` - For the list of NFS exports on the target NFS server.

